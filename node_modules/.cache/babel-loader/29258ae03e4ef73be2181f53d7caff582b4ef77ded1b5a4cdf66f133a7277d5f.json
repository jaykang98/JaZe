{"ast":null,"code":"import{FontAwesomeIcon}from\"@fortawesome/react-fontawesome\";import React,{useEffect,useState}from\"react\";import Button from\"../../ui/button/Button\";import{faKey,faPalette,faTrash}from\"@fortawesome/free-solid-svg-icons\";import{decrypt}from\"../../utils/Encryption\";import styles from\"./Settings.module.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Settings=()=>{const[userID,setUserID]=useState(localStorage.getItem('userID')||null);const[error,setError]=useState(null);useEffect(()=>{const fetchUserName=async()=>{if(userID)return;const encryptedToken=sessionStorage.getItem('authToken');const token=encryptedToken?decrypt(encryptedToken):null;const apiKey='053905e1fc8b0de378dc341a24ec68c7';const secret='a0c2b1ab664e5ea5ca735d57f4cdaaf8';const paramsString=\"api_key\".concat(apiKey,\"methodauth.getSessiontoken\").concat(token).concat(secret);const apiSig=CryptoJS.MD5(paramsString).toString();if(token){const url=\"https://ws.audioscrobbler.com/2.0/?method=auth.getSession&token=\".concat(token,\"&api_key=\").concat(apiKey,\"&api_sig=\").concat(apiSig,\"&format=json\");try{const response=await fetch(url);if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}const data=await response.json();if(data.session&&data.session.name){setUserID(data.session.name);localStorage.setItem('userID',data.session.name);}}catch(error){console.error(\"Failed to fetch session:\",error);setError(error);}}};fetchUserName();},[userID]);// Dependency on userID to prevent refetching if already set\nconst clearCacheAction=()=>{console.log('Clear cache action');localStorage.removeItem('userID');};const changeThemeAction=()=>{console.log('Change theme action');};const authenticationAction=()=>{const apiKey='053905e1fc8b0de378dc341a24ec68c7';const cbURL=encodeURIComponent(window.location.href);const url=\"https://www.last.fm/api/auth/?api_key=\".concat(apiKey,\"&cb=\").concat(cbURL);window.location.href=url;console.log('Get authorization action initiated.');};const settingsOptions=[{id:\"clearCache\",label:\"Clear Cache\",action:clearCacheAction,icon:faTrash},{id:\"themeSwap\",label:\"Change Theme\",action:changeThemeAction,icon:faPalette},{id:\"getAuth\",label:\"Authentication\",action:authenticationAction,icon:faKey}];return/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Settings\"}),/*#__PURE__*/_jsx(\"table\",{className:styles.settingsTable,children:/*#__PURE__*/_jsx(\"tbody\",{children:settingsOptions.map(option=>/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:option.icon})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"label\",{htmlFor:option.id,className:styles.label,children:option.label})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Button,{onClick:option.action,children:option.label})})]},option.id))})})]});};export default Settings;","map":{"version":3,"names":["FontAwesomeIcon","React","useEffect","useState","Button","faKey","faPalette","faTrash","decrypt","styles","jsx","_jsx","jsxs","_jsxs","Settings","userID","setUserID","localStorage","getItem","error","setError","fetchUserName","encryptedToken","sessionStorage","token","apiKey","secret","paramsString","concat","apiSig","CryptoJS","MD5","toString","url","response","fetch","ok","Error","status","data","json","session","name","setItem","console","clearCacheAction","log","removeItem","changeThemeAction","authenticationAction","cbURL","encodeURIComponent","window","location","href","settingsOptions","id","label","action","icon","children","className","settingsTable","map","option","htmlFor","onClick"],"sources":["C:/Users/jules/source/repos/jaykang98/jaze/src/components/Settings/Settings.tsx"],"sourcesContent":["import { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport Button from \"../../ui/button/Button\";\r\nimport { faKey, faPalette, faTrash } from \"@fortawesome/free-solid-svg-icons\";\r\nimport { decrypt } from \"../../utils/Encryption\";\r\nimport styles from \"./Settings.module.css\"\r\nconst Settings = () => {\r\n    const [userID, setUserID] = useState<string | null>(localStorage.getItem('userID') || null);\r\n    const [error, setError] = useState<any>(null);\r\n\r\n    useEffect(() => {\r\n        const fetchUserName = async () => {\r\n            if (userID) return;\r\n\r\n            const encryptedToken = sessionStorage.getItem('authToken');\r\n            const token = encryptedToken ? decrypt(encryptedToken) : null;\r\n            const apiKey = '053905e1fc8b0de378dc341a24ec68c7';\r\n            const secret = 'a0c2b1ab664e5ea5ca735d57f4cdaaf8';\r\n\r\n            const paramsString = `api_key${apiKey}methodauth.getSessiontoken${token}${secret}`;\r\n            const apiSig = CryptoJS.MD5(paramsString).toString();\r\n\r\n            if (token) {\r\n                const url = `https://ws.audioscrobbler.com/2.0/?method=auth.getSession&token=${token}&api_key=${apiKey}&api_sig=${apiSig}&format=json`;\r\n\r\n                try {\r\n                    const response = await fetch(url);\r\n                    if (!response.ok) {\r\n                        throw new Error(`HTTP error! status: ${response.status}`);\r\n                    }\r\n                    const data = await response.json();\r\n\r\n                    if (data.session && data.session.name) {\r\n                        setUserID(data.session.name);\r\n                        localStorage.setItem('userID', data.session.name);\r\n                    }\r\n                } catch (error) {\r\n                    console.error(\"Failed to fetch session:\", error);\r\n                    setError(error);\r\n                }\r\n            }\r\n        };\r\n\r\n        fetchUserName();\r\n    }, [userID]); // Dependency on userID to prevent refetching if already set\r\n    const clearCacheAction = () => {\r\n        console.log('Clear cache action');\r\n        localStorage.removeItem('userID');\r\n    };\r\n\r\n    const changeThemeAction = () => {\r\n        console.log('Change theme action');\r\n    };\r\n\r\n    const authenticationAction = () => {\r\n        const apiKey = '053905e1fc8b0de378dc341a24ec68c7';\r\n        const cbURL = encodeURIComponent(window.location.href);\r\n        const url = `https://www.last.fm/api/auth/?api_key=${apiKey}&cb=${cbURL}`;\r\n        window.location.href = url;\r\n        console.log('Get authorization action initiated.');\r\n    };\r\n\r\n\r\n  const settingsOptions = [\r\n    {\r\n      id: \"clearCache\",\r\n      label: \"Clear Cache\",\r\n      action: clearCacheAction,\r\n      icon: faTrash,\r\n    },\r\n    {\r\n      id: \"themeSwap\",\r\n      label: \"Change Theme\",\r\n      action: changeThemeAction,\r\n      icon: faPalette,\r\n    },\r\n    {\r\n      id: \"getAuth\",\r\n      label: \"Authentication\",\r\n      action: authenticationAction,\r\n      icon: faKey,\r\n    },\r\n  ];\r\n\r\n    return (\r\n        <section>\r\n            <h2>Settings</h2>\r\n            <table className={styles.settingsTable}>\r\n                <tbody>\r\n                    {settingsOptions.map(option => (\r\n                        <tr key={option.id}>\r\n                            <td><FontAwesomeIcon icon={option.icon} /></td>\r\n                            <td><label htmlFor={option.id} className={styles.label}>{option.label}</label></td>\r\n                            <td><Button onClick={option.action}>{option.label}</Button></td>\r\n                        </tr>\r\n                    ))}\r\n                </tbody>\r\n            </table>\r\n        </section>\r\n    );\r\n};\r\n\r\nexport default Settings;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}